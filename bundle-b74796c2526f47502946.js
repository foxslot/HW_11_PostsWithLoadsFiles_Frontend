!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(0);const o="https://foxslot-vs-posts.herokuapp.com",i=new class{constructor(t){this.baseUrl=t}getJSON(t,e,n){this.makeRequest(t,"GET",[],null,e,n)}postJSON(t,e,n,o){null!==e?this.makeRequest(t,"POST",[{name:"Content-Type",value:"application/json"}],JSON.stringify(e),n,o):this.makeRequest(t,"POST",[],null,n,o)}deleteJSON(t,e,n,o){this.makeRequest(t,"DELETE",[],null,n,o)}makeRequest(t,e,n=[],o=[],i,r){const s=new XMLHttpRequest;s.open(e,`${this.baseUrl}${t}`);for(const t of n)s.setRequestHeader(t.name,t.value);s.addEventListener("load",t=>{if(s.status>=200&&s.status<300){const t=JSON.parse(s.responseText);void 0!==i&&i(t)}else void 0!==r&&r(s.statusText)}),s.addEventListener("error",t=>{void 0!==r&&r("Unexpected error")}),s.send(o)}}(o),r=document.getElementById("root");let s=[];const a=!1;let l=0,d=0;const c=5,u=document.createElement("form");r.appendChild(u);const m=J("div","form-row",u),p=J("div","form-group col-md-7",m),f=J("div","form-group col-md-3",m),v=J("div","form-group col-md-2",m),b=J("input","form-control my-2 mr-sm-2",p);b.placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É",b.setAttribute("data-id","link");const y=J("select","custom-select my-2 mr-sm-2",f);y.setAttribute("data-id","type");!function(t,e){for(const n of e){const e=document.createElement("option");e.value=n,"regular"===e.value?e.textContent="–û–±—ã—á–Ω—ã–π":"image"===e.value?e.textContent="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ":"audio"===e.value?e.textContent="–ê—É–¥–∏–æ":"video"===e.value?e.textContent="–í–∏–¥–µ–æ":e.textContent=n,t.appendChild(e)}}(y,["regular","image","audio","video"]);const h=J("button","btn btn-primary my-2 mr-sm-2",v);h.textContent="–î–æ–±–∞–≤–∏—Ç—å";const C=u.querySelector("[data-id=link]"),g=u.querySelector("[data-id=type]");u.onsubmit=function(t){t.preventDefault();const e={typeContent:g.value,linkContent:C.value,id:0,content:C.value};i.postJSON("/posts",e,R,D),C.value="",g.value="regular",w.textContent="–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ñ–∞–π–ª–æ–º. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞, —Ñ–∞–π–ª –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å",T.innerHTML="",$.textContent="–ü–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –≤–∏–¥–µ–æ, —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–≥–æ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Ñ–æ—Ä–º—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞"};const x=document.createElement("form");r.appendChild(x),x.id="simple",x.action=`${o}/upload`,x.method="POST",x.enctype="multipart/form-data";const k=J("div","form-group",x),w=document.createElement("label");k.appendChild(w),w.for="exampleFormControlFile1",w.textContent="–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ñ–∞–π–ª–æ–º. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞, —Ñ–∞–π–ª –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å";const E=J("input","form-control-file",k);E.type="file",E.name="media",document.querySelector("input[name=media]").addEventListener("change",t=>{t.preventDefault();const[e]=Array.from(t.currentTarget.files),n=new FormData;n.append("media",e),h.disabled=!0,w.textContent="–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...",fetch(`${o}/upload`,{method:"POST",body:n}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=`${o}/static/${t.name}`;b.value=n,"image/png"===e.type||"image/jpeg"===e.type||"image/gif"===e.type?g.value="image":"application/octet-stream"===e.type||"video/webm"===e.type?g.value="video":"audio/webm"===e.type||"audio/wave"===e.type?g.value="audio":g.value="regular",w.textContent="–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω"}).catch(t=>{console.log(t),w.textContent=`–û—à–∏–±–∫–∞! –§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω.${t}`}).finally(()=>{h.disabled=!1}),t.currentTarget.value=""});const S=J("button","btn btn-primary my-2 mr-sm-2",x);S.textContent="–î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ";const $=J("p","card-text",x);$.textContent="–ü–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –≤–∏–¥–µ–æ, —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–≥–æ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Ñ–æ—Ä–º—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞";const T=document.createElement("div");x.appendChild(T),S.addEventListener("click",t=>{if(t.preventDefault(),T.innerHTML="",!navigator.mediaDevices){const t=document.createElement("div");return t.textContent="Your browser not support media! Use Yande Browser.",void document.body.appendChild(t)}const e=document.createElement("video");if(e.id="output",e.width="400",e.height="300",T.appendChild(e),!window.MediaRecorder){const t=document.createElement("div");return t.textContent="Your browser not media recordering! Use Yande Browser.",void document.body.appendChild(t)}navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(t=>{const n=new MediaRecorder(t,{mediaType:"video/webm"}),i=[];n.addEventListener("dataavailable",t=>{i.push(t.data)}),n.addEventListener("stop",n=>{t.getTracks().forEach(t=>t.stop());const r=new Blob(i);e.srcObject=null;const s=new FormData;s.append("media",r),fetch(`${o}/upload`,{method:"POST",body:s}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=`${o}/static/${t.name}`;e.src=n,e.controls=!0,e.muted=!0,e.play(),$.textContent="–í–∏–¥–µ–æ –∑–∞–ø–∏—Å–∞–Ω–æ, —Å—Å—ã–ª–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞",b.value=n,g.value="video"}).catch(t=>{console.log(t)})}),n.start(),e.srcObject=t,e.muted=!0,e.controls=!1,e.play(),$.textContent="–ò–¥–µ—Ç –∑–∞–ø–∏—Å—å –≤–∏–¥–µ–æ...",setTimeout(()=>{n.stop()},5e3)}).catch(t=>{console.log(t)})});const O=J("button","btn btn-primary d-block mx-auto mt-2",r);O.textContent="–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã",O.setAttribute("data-id","load-new-posts-button"),O.addEventListener("click",(function(){fetch(`${o}/get-new-posts/${d}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{"false"!==t&&(M(t),O.classList.toggle("button-invisibility"),N())}).catch(t=>{console.log(t)})})),O.classList.toggle("button-invisibility");const j=J("ul","list-group",r),q=J("button","btn btn-primary d-block mx-auto mt-2",r);function L(){fetch(`${o}/posts/${l}/${c}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{if(t.length>=c)M(t),r.appendChild(q);else if(0===t.length){const t=r.querySelector("[data-id=load-more-button]");r.removeChild(t)}else{M(t);const e=r.querySelector("[data-id=load-more-button]");r.removeChild(e)}a||(setInterval(()=>{fetch(`${o}/new-posts/${d}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.text()}).then(t=>{"false"!==t&&(O.classList.remove("button-invisibility"),O.textContent=`–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã (${t})`)}).catch(t=>{console.log(t)})},5e3),a=!0)}).catch(t=>{console.log(t)})}function M(t){for(const n of t)if(-1===!A(n.id))e=n.id,fetch(`${o}/post/${e}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=s[A(t.id)];e.likes=t.likes;const n=j.querySelector(`[data-post-id = ${e.id}]`),o=n.querySelector("[data-id = button-like]");o.textContent="‚ù§ "+e.likes}).catch(t=>{console.log(t)});else{const t=J("div","card my-2 mr-sm-2",j);t.setAttribute("data-post-id",`${n.id}`);let e="";if("regular"===n.typeContent){J("h5","card-text ml-3",t).textContent=n.linkContent,e="–ü–æ—Å—Ç —Å —Ç–µ–∫—Å—Ç–æ–º"}else if("image"===n.typeContent){J("img","card-img-top",t).src=n.linkContent,e="–ü–æ—Å—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º"}else if("audio"===n.typeContent){const o=J("audio","card-img-top",t);o.src=n.linkContent,o.controls=!0,e="–ü–æ—Å—Ç —Å –∞—É–¥–∏–æ"}else if("video"===n.typeContent){const o=J("video","embed-responsive-item",t);o.src=n.linkContent,o.controls=!0,e="–ü–æ—Å—Ç —Å –≤–∏–¥–µ–æ"}else{J("p","card-text",t).textContent="–°–ø–∞–º",e="–ü–æ—Å—Ç —Å–æ —Å–ø–∞–º–æ–º"}const o=J("div","card-body",t);J("p","card-text",o).textContent=e;const r=J("button","btn btn-primary",o);r.textContent="‚ù§ "+n.likes,r.setAttribute("data-id","button-like"),r.onclick=function(){i.postJSON(`/posts/${n.id}/likes`,null,P,D)};const a=J("button","btn btn-primary ml-2",o);a.textContent="üëé",a.onclick=function(){i.deleteJSON(`/posts/${n.id}/likes`,null,P,D)},s.unshift(n)}var e;s.sort((t,e)=>e.id-t.id),l=s[s.length-1].id,d=s[0].id+1}function N(){s.sort((t,e)=>e.id-t.id),j.innerHTML="";for(const t of s){const e=J("div","card my-2 mr-sm-2",j);e.setAttribute("data-post-id",`${t.id}`);let n="";if("regular"===t.typeContent){J("h5","card-text ml-3",e).textContent=t.linkContent,n="–ü–æ—Å—Ç —Å —Ç–µ–∫—Å—Ç–æ–º"}else if("image"===t.typeContent){J("img","card-img-top",e).src=t.linkContent,n="–ü–æ—Å—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º"}else if("audio"===t.typeContent){const o=J("audio","card-img-top",e);o.src=t.linkContent,o.controls=!0,n="–ü–æ—Å—Ç —Å –∞—É–¥–∏–æ"}else if("video"===t.typeContent){const o=J("video","embed-responsive-item",e);o.src=t.linkContent,o.controls=!0,n="–ü–æ—Å—Ç —Å –≤–∏–¥–µ–æ"}else{J("p","card-text",e).textContent="–°–ø–∞–º",n="–ü–æ—Å—Ç —Å–æ —Å–ø–∞–º–æ–º"}const o=J("div","card-body",e);J("p","card-text",o).textContent=n;const r=J("button","btn btn-primary",o);r.textContent="‚ù§ "+t.likes,r.setAttribute("data-id","button-like"),r.onclick=function(){i.postJSON(`/posts/${t.id}/likes`,null,P,D)};const s=J("button","btn btn-primary ml-2",o);s.textContent="üëé",s.onclick=function(){i.deleteJSON(`/posts/${t.id}/likes`,null,P,D)}}}function J(t,e,n){const o=document.createElement(t);return o.className=e,n.appendChild(o),o}function P(t){const e=s[A(t.id)];e.likes=t.likes,j.querySelector(`[data-post-id="${e.id}"]`).querySelector("[data-id='button-like']").textContent="‚ù§ "+e.likes}function A(t){return s.findIndex(e=>e.id===t)}function R(t){s.unshift(t),d=s[0].id+1,N()}q.textContent="–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ",q.setAttribute("data-id","load-more-button"),q.addEventListener("click",L),r.removeChild(q);const D=t=>{console.log(t)};L()}]);